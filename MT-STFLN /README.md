# Traffic-flow-prediction

## 注意事项

<font face="微软雅黑" >需要注意的是，需要根据requirements.txt文件中指示的包进行安装，才能正常的运行程序！！！</font>
  
>* 首先，使用conda创建一个虚拟环境，如‘conda create traffic_speed’；  
> * 激活环境，conda activate traffic_speed；  
> * 安装环境，需要安装的环境已经添加在requirements.txt中，可以用conda安装，也可以使用pip安装，如：conda install tensorflow==1.12.0；  
> * 如果安装的是最新的tensorflow环境，也没问题，tensorflow的包按照以下方式进行导入即可：import tensorflow.compat.v1 as tf
tf.disable_v2_behavior()；  
> * 点击 run_train.py文件即可运行代码。
> * 需要注意的是，我们在tensorflow的1.12和1.14版本环境中都可以运行
---

## Experimental Results
### HA (Multi-steps)
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |6.617331 |6.617331 |6.617331 |6.617331 |6.617331 |6.617331 |
| RMSE           |10.358577|10.358577|10.358577|10.358577|10.358577|10.358577|
| MAPE           |0.426058 |0.426058 |0.426058 |0.426058 |0.426058 |0.426058 |
| R              |0.942935 |0.942935 |0.942935 |0.942935 |0.942935 |0.942935 |
| R<sup>2</sup>  |0.879848 |0.879848 |0.879848 |0.879848 |0.879848 |0.879848 | 
---
### ARIMA (Multi-steps)
#### ARIMA (train set 1)
|评价指标         |MAE      |RMSE     |MAPE     |
|  ----          | ----    |  ----   |----     |
| 6-1 steps      | 4.5418  | 6.6614	 | 39.71%  | 	
| 6-3 steps      | 4.7916  | 7.0453  | 40.35%  | 
| 6-6 steps      | 5.0737  | 7.4872	 | 41.43%  | 
---
### LSTM (Multi-steps)
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |4.616810 |4.717223 |4.835627 |5.047810 |5.240323 |5.392856 |
| RMSE           |6.912127 |7.258386 |7.413919 |7.878633 |8.199965 |8.509839 |
| MAPE           |0.315602 |0.328485 |0.331738 |0.339490 |0.345030 |0.353186 |
| R              |0.973207 |0.969313 |0.968838 |0.965702 |0.964192 |0.961400 |
| R<sup>2</sup>  |0.947065 |0.939477 |0.938519 |0.932416 |0.929450 |0.924006 | 
---
### LSTM_BILSTM (Multi-steps)
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |4.661809 |4.742533 |4.858965 |5.069581 |5.263103 |5.423886 |
| RMSE           |7.096615 |7.345597 |7.492882 |7.960687 |8.287750 |8.619274 |
| MAPE           |0.317031 |0.327794 |0.328891 |0.334256 |0.338309 |0.344798 |
| R              |0.971796 |0.968556 |0.968152 |0.964950 |0.963384 |0.960345 |
| R<sup>2</sup>  |0.944201 |0.938014 |0.937202 |0.931001 |0.927931 |0.922039 |  
---
### DELA (Multi-steps)
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |4.813334 |4.788256 |4.868773 |5.070986 |5.195093 |5.276653 |
| RMSE           |6.846341 |7.023863 |7.100444 |7.459512 |7.661881 |7.792933 |
| MAPE           |0.407130 |0.403445 |0.411464 |0.428897 |0.431811 |0.445788 |
| R              |0.974227 |0.971634 |0.971496 |0.969438 |0.968836 |0.967635 |
| R<sup>2</sup>  |0.948067 |0.943325 |0.943608 |0.939415 |0.938405 |0.936271 | 
---
### T-GCN (Multi-steps)  
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |4.643695 |4.734375 |4.814046 |4.962412 |5.093916 |5.175375 |
| RMSE           |6.837503 |7.160868 |7.256855 |7.601576 |7.826410 |7.957563 |
| MAPE           |0.358638 |0.374635 |0.374545 |0.376119 |0.379499 |0.384754 |
| R              |0.973821 |0.970133 |0.970182 |0.968136 |0.967490 |0.966372 |
| R<sup>2</sup>  |0.948201 |0.941092 |0.941096 |0.937086 |0.935732 |0.933549 | 
---
### STGNN (Multi-steps)
|  评价指标       |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |----     |----     |----     |----     |----     |
| MAE            |4.512238 |4.579119 |4.656612 |4.738897 |4.808662 |4.879196 |
| RMSE           |6.795296 |6.942279 |7.107975 |7.292534 |7.418278 |7.595171 |
| MAPE           |0.306675 |0.309785 |0.314120 |0.317842 |0.321344 |0.326065 |
| R              |0.975510 |0.974422 |0.973167 |0.971725 |0.970741 |0.969292 |
| R<sup>2</sup>  |0.951528 |0.949408 |0.946959 |0.944174 |0.942221 |0.939420 |
---
### AST-GAT (Multi-steps)
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |4.383588 |4.358691 |4.393848 |4.485453 |4.580289 |4.602143 |
| RMSE           |6.734658 |6.858531 |6.853069 |7.064220 |7.206659 |7.223728 |
| MAPE           |0.288962 |0.295460 |0.292290 |0.296182 |0.297829 |0.298959 |
| R              |0.977831 |0.975656 |0.976351 |0.975366 |0.975347 |0.975040 |
| R<sup>2</sup>  |0.949748 |0.945962 |0.947469 |0.945666 |0.945507 |0.945240 | 
---
### GMAN (Multi-steps)  
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |4.312884 |4.270043 |4.295379 |4.377302 |4.454337 |4.472442 |
| RMSE           |6.385426 |6.469501 |6.449712 |6.645567 |6.762545 |6.779461 |
| MAPE           |0.306976 |0.315717 |0.312488 |0.314717 |0.313440 |0.314405 |
| R              |0.977251 |0.975746 |0.976526 |0.975707 |0.975748 |0.975617 |
| R<sup>2</sup>  |0.954825 |0.951918 |0.953470 |0.951915 |0.952016 |0.951769 | 
---
### MT-STNet (Multi-steps) 
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |4.243290 |4.164090 |4.211545 |4.291115 |4.376773 |4.394378 |
| RMSE           |6.311412 |6.360391 |6.370458 |6.570564 |6.695103 |6.711143 |
| MAPE           |0.291198 |0.300016 |0.297566 |0.298230 |0.299677 |0.300442 |
| R              |0.977816 |0.976574 |0.977136 |0.976322 |0.976309 |0.976208 |
| R<sup>2</sup>  |0.955866 |0.953526 |0.954607 |0.952995 |0.952969 |0.952736 |  
---
### STNet (Multi-steps)
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |4.342740 |4.264150 |4.286956 |4.353868 |4.425250 |4.434163 |
| RMSE           |6.646892 |6.497790 |6.472476 |6.652350 |6.755280 |6.754442 |
| MAPE           |0.297516 |0.304397 |0.301575 |0.301453 |0.299813 |0.301061 |
| R              |0.976774 |0.975563 |0.976396 |0.975716 |0.975885 |0.975886 |
| R<sup>2</sup>  |0.953795 |0.951497 |0.953141 |0.951817 |0.952119 |0.952124 | 
---
### STNet-1 (Multi-steps) dynamic step-by-step way
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |4.473256 |4.398370 |4.429270 |4.489394 |4.564298 |4.565895 |
| RMSE           |6.592686 |6.637524 |6.618346 |6.779783 |6.886123 |6.880057 |
| MAPE           |0.315337 |0.325471 |0.321441 |0.321250 |0.319406 |0.320136 |
| R              |0.975855 |0.974508 |0.975378 |0.974852 |0.975042 |0.975090 |
| R<sup>2</sup>  |0.951844 |0.949388 |0.951006 |0.949954 |0.950247 |0.950327 | 
---
### STNet-2 (Multi-steps) not consider static spatial correlation
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |4.317427 |4.263939 |4.294882 |4.371245 |4.442778 |4.450352 |
| RMSE           |6.618741 |6.656160 |6.653438 |6.853755 |6.951396 |6.946535 |
| MAPE           |0.295039 |0.306607 |0.303767 |0.304929 |0.303507 |0.303628 |
| R              |0.977243 |0.975744 |0.976544 |0.975736 |0.975999 |0.976045 |
| R<sup>2</sup>  |0.954172 |0.951413 |0.952924 |0.951379 |0.951822 |0.951901 | 
---
### STNet-3 (Multi-steps) without physical information
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |4.357896 |4.290015 |4.313677 |4.383102 |4.455434 |4.463392 |
| RMSE           |6.500572 |6.538918 |6.506636 |6.680490 |6.784680 |6.786780 |
| MAPE           |0.287137 |0.298429 |0.296120 |0.296358 |0.295939 |0.296743 |
| R              |0.977097 |0.975762 |0.976647 |0.975954 |0.976086 |0.976049 |
| R<sup>2</sup>  |0.953181 |0.950881 |0.952646 |0.951409 |0.951702 |0.951665 |
---
### STNet-4 (Multi-steps) does not uses spatial attention
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |4.474162 |4.445554 |4.485958 |4.587262 |4.680753 |4.718502 |
| RMSE           |6.626417 |6.722309 |6.732861 |6.971318 |7.110558 |7.176844 |
| MAPE           |0.310140 |0.317896 |0.315816 |0.317411 |0.319461 |0.321222 |
| R              |0.975419 |0.973736 |0.974362 |0.973248 |0.973163 |0.972646 |
| R<sup>2</sup>  |0.951350 |0.948087 |0.949295 |0.947086 |0.946951 |0.945949 | 