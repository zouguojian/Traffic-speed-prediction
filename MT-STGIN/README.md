# Traffic-speed-prediction

## 注意事项

<font face="微软雅黑" >需要注意的是，需要根据requirements.txt文件中指示的包进行安装，才能正常的运行程序！！！</font>
  
>* first，please use the conda tool to crate a virtual environment, such as ‘conda create traffic_speed’；  
> * active the environment, and conda activate traffic_speed；  
> * build environment，需要安装的环境已经添加在requirements.txt中，可以用conda安装，也可以使用pip安装，如：conda install tensorflow==1.13.1；  
> * if you have installed the last TensorFlow version, its okay，tensorflow的包按照以下方式进行导入即可：import tensorflow.compat.v1 as tf
tf.disable_v2_behavior()；  
> * please click the run_train.py file; the codes are then running;
> * Note that our TensorFlow version is 1.13.1 and can also be operated on the 1.14.0 version.
---

## Experimental Results
### HA (Multi-steps)
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |6.185242 |6.185242 |6.185242 |6.185242 |6.185242 |6.185242 |
| RMSE           |10.139710|10.139710|10.139710|10.139710|10.139710|10.139710|
| MAPE           |0.126192 |0.126192 |0.126192 |0.126192 |0.126192 |0.126192 |
| R              |0.941854 |0.941854 |0.941854 |0.941854 |0.941854 |0.941854 |
| R<sup>2</sup>  |0.886221 |0.886221 |0.886221 |0.886221 |0.886221 |0.886221 | 
---
### ARIMA (Multi-steps)
#### toll to gantry 
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|total avg|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |----     |
| MAE            |4.423684 |4.405224 |4.446228 |4.365605 |4.574733 |4.555923 |4.461899 |
| RMSE           |7.269621 |7.243312 |7.250550 |7.131092 |7.443017 |7.447256 |7.298356 |
| MAPE           |0.168632 |0.110119 |0.133954 |0.107197 |0.111523 |0.112288 |0.123952 |
| R              |0.967787 |0.967922 |0.967487 |0.968696 |0.966449 |0.965865 |0.967345 |
| R<sup>2</sup>  |0.936544 |0.936809 |0.935600 |0.937870 |0.933811 |0.932530 |0.935525 |
#### gantry to gantry
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|total avg|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |----     |
| MAE            |5.324959 |5.396418 |5.435148 |5.783755 |5.893615 |5.452932 |5.547804 |
| RMSE           |8.658889 |8.660289 |8.746052 |9.449458 |9.474263 |8.572582 |8.935076 |
| MAPE           |0.060223 |0.100110 |0.068762 |0.068023 |0.105616 |0.077635 |0.080062 |
| R              |0.823453 |0.832350 |0.825310 |0.788966 |0.803852 |0.826240 |0.816555 |
| R<sup>2</sup>  |0.677427 |0.692779 |0.680892 |0.620437 |0.646086 |0.682447 |0.666584 |
#### gantry to toll 
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|total avg|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |----     |
| MAE            |6.881361 |7.205969 |7.299805 |7.429513 |7.193544 |7.447366 |7.242926 |
| RMSE           |10.667876|11.555709|11.370312|11.442060|10.952651|11.603274|11.270457|
| MAPE           |0.177266 |0.264612 |0.241900 |0.186826 |0.172088 |0.226629 |0.211553 |
| R              |0.929837 |0.919577 |0.922907 |0.919795 |0.925529 |0.917077 |0.922405 |
| R<sup>2</sup>  |0.864528 |0.845506 |0.851645 |0.845968 |0.856569 |0.840878 |0.850808 |
---
### SVM (Multi-steps)
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |5.622419 |5.694858 |5.636928 |5.902129 |5.898720 |5.929169 |
| RMSE           |9.541193 |9.459830 |9.366811 |9.714313 |9.744125 |9.761787 |
| MAPE           |0.111848 |0.114599 |0.126784 |0.138657 |0.142691 |0.127152 |
| R              |0.948368 |0.949696 |0.950375 |0.947028 |0.946775 |0.946549 |
| R<sup>2</sup>  |0.898497 |0.901055 |0.902324 |0.895883 |0.895211 |0.894915 | 
---
### LSTM (Multi-steps)
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |5.517776 |5.632012 |5.777946 |5.946635 |6.041769 |6.079495 |
| RMSE           |9.125115 |9.284576 |9.433199 |9.641906 |9.626469 |9.586535 |
| MAPE           |0.133428 |0.140966 |0.126444 |0.119835 |0.122028 |0.134512 |
| R              |0.952999 |0.951341 |0.949730 |0.946881 |0.947458 |0.947507 |
| R<sup>2</sup>  |0.908157 |0.904874 |0.901881 |0.896313 |0.897537 |0.897657 | 
---
### Bi-LSTM (Multi-steps)
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |5.524607 |5.632932 |5.771882 |5.954062 |6.055177 |6.096319 |
| RMSE           |9.129195 |9.285857 |9.423597 |9.640355 |9.636107 |9.591586 |
| MAPE           |0.132028 |0.140429 |0.127086 |0.122740 |0.127745 |0.141035 |
| R              |0.953077 |0.951397 |0.949857 |0.946916 |0.947363 |0.947457 |
| R<sup>2</sup>  |0.908075 |0.904848 |0.902081 |0.896346 |0.897331 |0.897549 |
---
### FI-RNNs (Multi-steps)
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |5.520539 |5.626097 |5.768340 |5.932466 |6.028442 |6.048296 |
| RMSE           |9.116093 |9.267610 |9.432268 |9.622239 |9.603523 |9.569430 |
| MAPE           |0.137907 |0.144544 |0.130363 |0.123199 |0.129686 |0.140039 |
| R              |0.953136 |0.951567 |0.949828 |0.947121 |0.947781 |0.947735 |
| R<sup>2</sup>  |0.908339 |0.905221 |0.901901 |0.896736 |0.898025 |0.898022 |  
---
### PSPNN (Multi-steps)
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |5.386255 |5.468801 |5.567571 |5.716054 |5.768782 |5.749586 |
| RMSE           |8.880815 |9.022358 |9.145341 |9.307195 |9.271415 |9.167632 |
| MAPE           |0.130217 |0.135699 |0.120082 |0.114041 |0.116743 |0.128589 |
| R              |0.955524 |0.954207 |0.952829 |0.950642 |0.951668 |0.952150 |
| R<sup>2</sup>  |0.913009 |0.910171 |0.907778 |0.903387 |0.904956 |0.906406 | 
---
### MDL (Multi-steps)
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |5.429035 |5.509909 |5.627575 |5.784230 |5.813673 |5.804645 |
| RMSE           |8.916788 |9.076988 |9.176666 |9.381263 |9.304234 |9.256170 |
| MAPE           |0.130555 |0.134097 |0.120055 |0.115990 |0.117240 |0.129795 |
| R              |0.955434 |0.953698 |0.952556 |0.949963 |0.951238 |0.951537 |
| R<sup>2</sup>  |0.912303 |0.909080 |0.907145 |0.901843 |0.904282 |0.904590 |  
---
### T-GCN (Multi-steps)  
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |5.670292 |5.675068 |5.746703 |5.863256 |5.888195 |5.831183 |
| RMSE           |9.134161 |9.173527 |9.245162 |9.387154 |9.317363 |9.195807 |
| MAPE           |0.138232 |0.141509 |0.124293 |0.118078 |0.119514 |0.132048 |
| R              |0.953061 |0.952621 |0.951832 |0.949719 |0.950864 |0.951782 |
| R<sup>2</sup>  |0.907975 |0.907136 |0.905754 |0.901720 |0.904011 |0.905830 | 
---
### DCRNN (Multi-steps)  
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |5.808297 |5.788443 |5.794671 |5.819892 |5.836586 |5.867232 |
| RMSE           |9.389112 |9.371624 |9.375622 |9.404970 |9.420036 |9.460167 |
| MAPE           |0.137371 |0.133297 |0.133757 |0.134122 |0.133960 |0.135183 |
| R              |0.950188 |0.950462 |0.950404 |0.950128 |0.949942 |0.949522 |
| R<sup>2</sup>  |0.902386 |0.902738 |0.902651 |0.902037 |0.901720 |0.900876 | 
---
### AST-GAT (Multi-steps)
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |5.248924 |5.258951 |5.329265 |5.428566 |5.421416 |5.314834 |
| RMSE           |8.705578 |8.784430 |8.828416 |8.943468 |8.809244 |8.712925 |
| MAPE           |0.124102 |0.128212 |0.114900 |0.110572 |0.110653 |0.121733 |
| R              |0.957302 |0.956514 |0.956069 |0.954439 |0.956152 |0.956983 |
| R<sup>2</sup>  |0.916408 |0.914847 |0.914059 |0.910791 |0.914195 |0.915460 | 
---
### GMAN (Multi-steps)  
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |5.233438 |5.208744 |5.256062 |5.329036 |5.347667 |5.204790 |
| RMSE           |8.730351 |8.795372 |8.797104 |8.908348 |8.818618 |8.598270 |
| MAPE           |0.130036 |0.131432 |0.116220 |0.107743 |0.111887 |0.117915 |
| R              |0.957150 |0.956506 |0.956505 |0.954913 |0.956238 |0.958076 |
| R<sup>2</sup>  |0.915932 |0.914634 |0.914668 |0.911490 |0.914013 |0.917670 | 
---
### GMAN_1 (without decoder on spatiotemporal attention)  
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |5.234585 |5.178617 |5.211098 |5.287373 |5.322027 |5.223792 |
| RMSE           |8.734820 |8.744925 |8.779705 |8.879185 |8.817018 |8.640688 |
| MAPE           |0.130630 |0.128092 |0.114170 |0.106051 |0.110179 |0.120951 |
| R              |0.957045 |0.956970 |0.956621 |0.955153 |0.956184 |0.957628 |
| R<sup>2</sup>  |0.915846 |0.915611 |0.915005 |0.912069 |0.914044 |0.916856 | 
---
### ST-GRAT (Multi-steps)  
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |5.126567 |5.224280 |5.335337 |5.456082 |5.562169 |5.662242 |
| RMSE           |8.719842 |8.848616 |8.980233 |9.120206 |9.243639 |9.359533 |
| MAPE           |0.117111 |0.119548 |9.243639 |0.124147 |0.126001 |0.127665 |
| R              |0.957088 |0.956256 |0.126001 |0.954598 |0.953828 |0.953095 |
| R<sup>2</sup>  |0.915784 |0.913271 |0.910662 |0.907852 |0.905335 |0.902939 | 
---
### MT-STGIN (Multi-steps) 
#### toll to gantry 
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|total avg|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |----     |
| MAE            |4.167658 |4.152724 |4.225301 |4.129288 |4.343058 |4.132023 |4.191676 |
| RMSE           |7.233356 |7.331061 |7.390471 |7.154604 |7.542089 |6.995177 |7.276548 |
| MAPE           |0.161414 |0.109230 |0.118732 |0.107747 |0.125871 |0.093290 |0.119381 |
| R              |0.963540 |0.962672 |0.961923 |0.964170 |0.960655 |0.965742 |0.963101 |
| R<sup>2</sup>  |0.928139 |0.926573 |0.925100 |0.929420 |0.922677 |0.932550 |0.927397 |  
#### gantry to gantry
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|total avg|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |----     |
| MAE            |4.682971 |4.588183 |4.672132 |4.860928 |4.832805 |4.613521 |4.708423 |
| RMSE           |7.956369 |8.014418 |8.377290 |8.592709 |8.402509 |7.933352 |8.216736 |
| MAPE           |0.072753 |0.096213 |0.064088 |0.067078 |0.072708 |0.082680 |0.075920 |
| R              |0.850528 |0.851597 |0.836524 |0.820580 |0.839457 |0.851166 |0.841604 |
| R<sup>2</sup>  |0.722064 |0.722921 |0.697487 |0.667630 |0.703124 |0.722782 |0.706155 | 
#### gantry to toll 
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|total avg|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |----     |
| MAE            |6.884369 |6.772877 |6.750407 |6.943268 |6.745666 |6.883471 |6.830010 |
| RMSE           |10.983397|10.887800|10.592183|10.859518|10.464038|10.828980|10.770837|
| MAPE           |0.183126 |0.204971 |0.188529 |0.169706 |0.149622 |0.202187 |0.183024 |
| R              |0.928699 |0.930042 |0.934506 |0.930023 |0.933884 |0.929958 |0.931160 |
| R<sup>2</sup>  |0.862049 |0.864070 |0.873075 |0.864540 |0.871463 |0.864164 |0.866561 | 
---
### STGIN_1 (Multi-steps) without semantic transformation
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |5.177275 |5.109780 |5.187932 |5.239958 |5.257546 |5.156742 |
| RMSE           |8.631874 |8.640737 |8.729155 |8.806985 |8.720966 |8.515376 |
| MAPE           |0.132412 |0.131180 |0.117357 |0.109338 |0.113217 |0.120528 |
| R              |0.958046 |0.957964 |0.957082 |0.955788 |0.957056 |0.958787 |
| R<sup>2</sup>  |0.917799 |0.917613 |0.915979 |0.913479 |0.915884 |0.919233 | 
---
### STGIN_2 (Multi-steps) uses an encoder of GMAN to replace the of ST-Block STGIN
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |5.195487 |5.116568 |5.174414 |5.246917 |5.274146 |5.178238 |
| RMSE           |8.718395 |8.693000 |8.744741 |8.864868 |8.775015 |8.614857 |
| MAPE           |0.127035 |0.129896 |0.113813 |0.105365 |0.108400 |0.119232 |
| R              |0.957350 |0.957625 |0.957099 |0.955481 |0.956771 |0.958061 |
| R<sup>2</sup>  |0.916143 |0.916614 |0.915679 |0.912338 |0.914838 |0.917335 | 
---
### STGIN_3 (Multi-steps) dynamic step-by-step method to replace the generative inference of STGIN
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
| MAE            |5.182895 |5.167289 |5.197474 |5.254837 |5.308890 |5.164660 |
| RMSE           |8.666809 |8.727748 |8.737943 |8.846064 |8.761161 |8.555215 |
| MAPE           |0.126229 |0.129717 |0.114406 |0.107089 |0.108753 |0.117827 |
| R              |0.957731 |0.957168 |0.957062 |0.955487 |0.956708 |0.958486 |
| R<sup>2</sup>  |0.917151 |0.915942 |0.915812 |0.912723 |0.915129 |0.918493 | 
---